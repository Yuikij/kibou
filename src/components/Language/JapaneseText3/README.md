# JapaneseText3 组件功能文档

## 组件概述

JapaneseText3 是一个高级的日语文本显示组件，专为日语学习和阅读设计。该组件提供了丰富的功能来帮助用户更好地理解和学习日语文本。

## 主要功能特性

### 1. 文本显示和渲染
- **多种文本输入格式支持**
  - 支持文本数组 (`texts`)
  - 支持完整文本数组 (`fullText`)
  - 支持单独的翻译、注音和笔记数据
- **响应式布局设计**
  - 适配移动端、平板和桌面设备
  - 动态调整组件布局和字体大小
- **优雅的视觉设计**
  - 渐变背景和阴影效果
  - 圆角边框和现代化界面
  - 支持亮色和暗色主题

### 2. 注音系统 (Furigana)
- **Ruby标记支持**
  - 使用标准HTML Ruby元素显示注音
  - 支持汉字上方显示假名读音
- **智能注音处理**
  - 自动解析注音数据
  - 支持复杂词汇的注音分割
- **交互式注音显示**
  - 可切换注音显示/隐藏
  - 鼠标悬停时注音高亮显示

### 3. 笔记系统
- **多类型笔记支持**
  - 词汇笔记 (vocabulary) 📚
  - 语法笔记 (grammar) 📝
  - 文化笔记 (cultural) 🏮
  - 发音笔记 (pronunciation) 🔊
- **内联笔记面板**
  - 点击高亮词汇显示详细笔记
  - 智能定位，避免超出屏幕边界
  - 支持移动端全屏显示模式
- **笔记高亮显示**
  - 不同类型笔记使用不同颜色
  - 渐变背景和下划线标识
  - 无障碍访问支持

### 4. 翻译功能
- **对照翻译显示**
  - 原文下方显示对应翻译
  - 斜体样式区分原文和翻译
  - 可切换翻译显示/隐藏
- **智能翻译匹配**
  - 支持句子级别的翻译对应
  - 自动处理翻译数组长度不匹配

### 5. 控制面板
- **显示选项控制**
  - 注音显示开关 (快捷键: F)
  - 翻译显示开关 (快捷键: T)
  - 笔记显示开关 (快捷键: N)
- **字体设置**
  - 三种字体大小：小、中、大
  - 三种行间距：紧凑、正常、宽松
- **主题切换**
  - 支持亮色/暗色主题
  - 自动适配系统主题设置

### 6. 键盘快捷键
- **功能切换快捷键**
  - `F` - 切换注音显示
  - `T` - 切换翻译显示
  - `N` - 切换笔记显示
  - `L` - 切换行号显示
- **字体调整快捷键**
  - `+` / `=` - 增大字体
  - `-` - 减小字体
- **笔记导航快捷键**
  - `Escape` - 关闭当前笔记
  - `→` - 下一个笔记
  - `←` - 上一个笔记

### 7. 行号系统
- **可选行号显示**
  - 左侧显示行号
  - 等宽字体确保对齐
  - 支持点击跳转功能
- **交互式行号**
  - 鼠标悬停高亮效果
  - 支持键盘导航
  - 无障碍标签支持

### 8. 文本处理和分割
- **智能文本分割**
  - 自动识别汉字、假名和标点
  - 支持复杂文本结构解析
  - 处理注音和笔记的位置对应
- **多级文本验证**
  - 输入数据格式验证
  - 运行时错误检测
  - 用户友好的错误提示

### 9. 无障碍功能 (Accessibility)
- **ARIA标签支持**
  - 完整的屏幕阅读器支持
  - 语义化HTML结构
  - 键盘导航友好
- **高对比度模式**
  - 支持系统高对比度设置
  - 增强边框和颜色对比
- **减少动画模式**
  - 尊重用户的动画偏好设置
  - 可禁用所有动画效果

### 10. 性能优化
- **React优化**
  - 使用React.memo防止不必要的重渲染
  - useMemo和useCallback优化计算
  - 懒加载和虚拟滚动支持
- **内存管理**
  - 智能缓存机制
  - 自动清理无用引用
  - 性能监控和统计

### 11. 状态管理
- **用户偏好设置持久化**
  - 本地存储用户设置
  - 跨会话保持偏好
  - 设置导入/导出功能
- **组件状态管理**
  - 集中式状态管理
  - 不可变状态更新
  - 状态变化监听

### 12. 错误处理
- **错误边界保护**
  - 组件级错误捕获
  - 优雅的错误降级
  - 开发模式详细错误信息
- **数据验证**
  - 全面的输入数据验证
  - 详细的错误报告
  - 数据清理和标准化

### 13. 开发工具
- **开发模式功能**
  - 性能统计面板
  - 组件状态调试
  - 数据验证报告
- **类型检查**
  - PropTypes验证
  - 运行时类型检查
  - 开发时警告提示

## 技术特性

### 架构设计
- **模块化架构**: 组件、hooks、工具函数分离
- **可扩展设计**: 支持自定义主题和插件
- **测试友好**: 完整的测试覆盖和mock支持

### 样式系统
- **CSS模块化**: 避免样式冲突
- **CSS变量**: 支持主题定制
- **响应式设计**: 移动端优先的设计理念

### 数据流管理
- **单向数据流**: 清晰的数据传递路径
- **状态提升**: 合理的状态管理层次
- **副作用隔离**: 使用hooks管理副作用

## 使用场景

1. **日语学习应用**: 提供注音、翻译和笔记功能
2. **在线阅读平台**: 支持日语文章的深度阅读
3. **教育软件**: 适用于日语教学和考试系统
4. **翻译工具**: 支持对照翻译和语言学习
5. **内容管理系统**: 管理和展示日语内容

## 浏览器兼容性

- **现代浏览器**: Chrome 88+, Firefox 85+, Safari 14+, Edge 88+
- **移动浏览器**: iOS Safari 14+, Chrome Mobile 88+
- **特殊支持**: 屏幕阅读器、高对比度模式

## 最近优化

✅ **已移除鼠标悬停卡片突起效果**
- 移除了TextBlock组件的悬停突起动画
- 移除了LineNumber组件的悬停缩放效果
- 移除了AnnotatedText组件的悬停特效
- 保持了基本的悬停颜色变化，提升用户体验
- 优化了性能，减少了不必要的动画开销

这个优化使界面更加简洁，减少了视觉干扰，同时保持了良好的交互反馈。
